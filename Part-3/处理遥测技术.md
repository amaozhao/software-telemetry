# 处理遥测技术

第 1 部分向你介绍了遥测系统的整体架构，第 2 部分给出了各种设置下的现实世界遥测系统的许多示例。我希望你在第 2 部分中找到了一些熟悉的基础。第 3 部分是关于具体技术的。这部分是一个工具箱；每一章都解决遥测系统面临的问题。

> 注意 尽管第 12 章中的结构化日志记录概念在第 13-16 章中再次出现，但可以选择性地阅读这些章节。因此，无论你还打算阅读什么内容，都应该考虑阅读第 12 章。

第 11 章深入探讨遥测系统的性能祸根：正则表达式。如果你的遥测系统必须处理来自硬件系统的遥测数据，则很难避免功能强大但速度缓慢的正则表达式。本章提供了几种简单的技术来加速你无法避免的正则表达式。不是每个人都需要优化正则表达式，但如果你这样做，你就真的这样做了。

第 12 章介绍标准化日志记录格式以及如何构建它们。当你能够控制遥测数据发出的格式（例如你的组织编写的生产代码）时，可以实现可维护性和性能的巨大提升。实现这一目标需要做一些工作（有关该故事，请参阅第 4.2 节），但本章将介绍制定标准的技术细节。

第 13 章提供了在发送（和接收）遥测数据时完全避免文件的方法。通过 TCP 套接字或 UDP 数据报发送遥测数据可以避免潜在昂贵的磁盘 I/O。有时，你需要在现有方法之外构建一个额外的发送方法来处理特殊需求，例如发送分布式跟踪遥测数据。 Kubernetes 和 FaaS 技术也需要发出遥测数据，有时，它们的内置方法不够好。

第 14 章深入探讨了遥测数据存储中索引基数的技术问题。将基数作为整体遥测系统设计的一部分，为你的成功扩展做好准备。本章介绍了解决基数问题的几种技术。

第 15 章讨论遥测系统安全性，因为遥测系统是支持组织的监管和合规工作的关键系统。攻击者（内部和外部）喜欢修改遥测技术以隐藏他们的踪迹，因此本章将讨论防止此类篡改或使此类篡改明显的方法。遥测数据可以支持法律诉讼，因此如果你担心这一点，请注意本章。

第 16 章介绍了很少有遥测系统操作员考虑的程序，直到为时已晚：如何在数据泄漏后进行清理。全球范围内的隐私立法正在慢慢地使某些类型的数据难以处理，例如健康信息、个人身份信息 (PII) 和财务详细信息，因此你的遥测系统必须准备好在泄漏后进行清理。如果你的生产系统处理任何类型的受监管信息，你的遥测系统最终可能会意外地以带有参数和其他日志记录数据的异常跟踪的形式存储其中一些信息。

第 17 章深入探讨了遥测系统成本的更大驱动因素之一：庞大的数据存储成本。数据聚合和保留策略可让你节省存储成本，但代价是无法长时间拥有全分辨率数据。本章介绍如何设置聚合和保留策略，并展示它们如何与监管和合规框架相结合。

第 18 章为你提供指导，帮助你应对遥测系统操作员遇到的最可怕的事情之一：法庭命令生成或保存数据。某些行业比其他行业更容易收到此类司法要求，但如果你的组织收到这些要求，你会感谢自己至少制定了一些草拟的程序来处理这些要求。本章不是法律建议；它可以帮助你帮助组织的法律团队。你不会直接收到传票；它将首先通过你自己的律师。